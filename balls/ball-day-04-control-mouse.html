<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>day-04 mouse</title>    
    <style>
      body {
        margin: 30px auto;
        text-align: center;
        background-color: #161414;
        color: #999;
      }

      #board canvas {
        border: 1px solid #333;
        background-color: #000;
        -webkit-box-shadow: 0px 0px 24px 0px rgba(0, 0, 0, 1);
        -moz-box-shadow: 0px 0px 24px 0px rgba(0, 0, 0, 1);
        box-shadow: 0px 0px 24px 0px rgba(0, 0, 0, 1);
        border-radius: 10px;
      }
    </style>
  </head>
  <body>
    <div id="board">
      <canvas width="800" height="600"></canvas>
    </div>
    <script type="module">
      import MouseControls from "./lib/MouseControls.js";
      const canvas = document.querySelector("#board canvas");
      const ctx = canvas.getContext("2d");
      const { width: w, height: h } = canvas;
      const mouse = new MouseControls(canvas);

      function drawBall(context, x, y, r, color) {
        // context.arc(x, y, r, startAngle, endAngle) method to draw a ball
        // x and y are the position
        // r is the radius
        // startAngle and endAngle are between 0 and 2pi. i.e., arc(x, y, r, 0, Math.PI*2)
        context.beginPath();
        context.arc(x, y, r, 0, Math.PI * 2);
        context.font = "12px Comic Sans MS";
        context.fillText(`${x}, ${y}`, x + r, y + r);
        context.fillStyle = color;
        context.fill();
      }

      // Game setup code
      let x = w / 2;
      let y = h / 2;
      const r = 25;
      let color = 0;

      function loopy() {
        requestAnimationFrame(loopy);

        ctx.clearRect(0, 0, w, h);

        // Game logic code
        const x = mouse.pos.x;
        const y = mouse.pos.y;

        if (mouse.pressed) {
          color += 10;
          if (color > 360) {
            color -= 360;
          }
        }
        draw_grid(ctx);
        drawBall(ctx, x, y, r, `hsl(${color}, 50%, 50%)`);
        mouse.update();
      }

      requestAnimationFrame(loopy);

      function draw_grid(ctx, minor, major, stroke, fill) {
        minor = minor || 10;
        major = major || minor * 5;
        stroke = stroke || "#00FF00";
        fill = fill || "#009900";
        ctx.save();
        ctx.strokeStyle = stroke;
        ctx.fillStyle = fill;
        for(var x = 0; x < ctx.canvas.width; x += minor) {
          ctx.beginPath();
          ctx.moveTo(x, 0);
          ctx.lineTo(x, ctx.canvas.height);
          ctx.lineWidth = (x % major == 0) ? 0.5 : 0.25;
          ctx.stroke();
          if(x % major == 0 ) {ctx.fillText(x, x, 10);}
        }
        for(var y = 0; y < ctx.canvas.height; y += minor) {
          ctx.beginPath();
          ctx.moveTo(0, y);
          ctx.lineTo(ctx.canvas.width, y);
          ctx.lineWidth = (y % major == 0) ? 0.5 : 0.25;
          ctx.stroke();
          if(y % major == 0 ) {ctx.fillText(y, 0, y + 10);}
        }
        ctx.restore();
      }

      
    </script>
  </body>
</html>
